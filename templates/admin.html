<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Admin Panel</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <!-- Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#1976D2',
                        'primary-dark': '#1565C0',
                        'secondary': '#424242',
                        'accent': '#FF4081',
                    }
                }
            }
        }
    </script>

    <style>
        .sidebar {
            background: linear-gradient(180deg, #1976D2 0%, #1565C0 100%);
        }
        .card-shadow {
            box-shadow: 0 2px 4px -1px rgba(0,0,0,0.2), 0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12);
        }
        .hover-lift:hover {
            transform: translateY(-2px);
            transition: transform 0.2s ease;
        }
        .active-nav {
            background-color: rgba(255, 255, 255, 0.1);
        }
        .status-pending { background-color: #fef3c7; color: #92400e; }
        .status-preparing { background-color: #ffedd5; color: #c2410c; }
        .status-completed { background-color: #dcfce7; color: #166534; }
        .status-cancelled { background-color: #fee2e2; color: #991b1b; }
    </style>
</head>

<body class="bg-gray-100 min-h-screen">
    <div class="flex h-screen">
        <!-- Sidebar -->
        <div class="sidebar w-64 text-white flex flex-col">
            <!-- Logo -->
            <div class="p-6 border-b border-blue-400">
                <div class="flex items-center gap-3">
                    <span class="material-icons text-2xl">restaurant</span>
                    <h1 class="text-xl font-bold">RESTAURANT</h1>
                </div>
                <p class="text-blue-200 text-sm mt-1">MANAGEMENT SYSTEM</p>
            </div>

            <!-- User Info -->
            <div class="p-4 border-b border-blue-400">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-blue-300 rounded-full flex items-center justify-center">
                        <span class="material-icons">person</span>
                    </div>
                    <div>
                        <p class="font-semibold">Admin User</p>
                        <p class="text-blue-200 text-sm">admin@restaurant.com</p>
                        <p class="text-green-300 text-sm">‚óè Online</p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 p-4">
                <p class="text-blue-200 text-sm font-semibold mb-4">MAIN NAVIGATION</p>
                <ul class="space-y-2">
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg bg-blue-700 text-white" data-section="dashboard">
                            <span class="material-icons">dashboard</span>
                            <span>Dashboard</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg hover:bg-blue-700 text-white transition" data-section="products">
                            <span class="material-icons">fastfood</span>
                            <span>Products</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg hover:bg-blue-700 text-white transition" data-section="menu">
                            <span class="material-icons">menu_book</span>
                            <span>Menu Management</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg hover:bg-blue-700 text-white transition" data-section="orders">
                            <span class="material-icons">receipt</span>
                            <span>Orders</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg hover:bg-blue-700 text-white transition" data-section="customers">
                            <span class="material-icons">group</span>
                            <span>Customers</span>
                        </a>
                    </li>
                    <li>
                        <a href="#" class="nav-item flex items-center gap-3 p-3 rounded-lg hover:bg-blue-700 text-white transition" data-section="analytics">
                            <span class="material-icons">analytics</span>
                            <span>Analytics</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Bar -->
            <header class="bg-white border-b border-gray-200 p-4">
                <div class="flex justify-between items-center">
                    <div>
                        <h2 class="text-lg font-semibold text-gray-600" id="breadcrumb">Home / Dashboard</h2>
                    </div>
                    <div class="flex items-center gap-4">
                        <button class="material-icons text-gray-600 hover:text-primary">notifications</button>
                        <button class="material-icons text-gray-600 hover:text-primary">help</button>
                        <button class="material-icons text-gray-600 hover:text-primary">settings</button>
                    </div>
                </div>
            </header>

            <!-- Content Area -->
            <main class="flex-1 overflow-y-auto p-6">
                <!-- Dashboard Section -->
                <div id="dashboard" class="content-section">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Dashboard</h1>
                                <p class="text-gray-600">Welcome to your restaurant admin panel</p>
                            </div>
                            <div class="text-sm text-gray-500">
                                Today: <span id="currentDate"></span>
                            </div>
                        </div>
                    </div>

                    <!-- Stats Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                        <div class="bg-white rounded-lg card-shadow p-6 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Total Products</p>
                                    <h3 class="text-2xl font-bold text-gray-800" id="totalProducts">0</h3>
                                </div>
                                <div class="p-3 bg-blue-100 rounded-full">
                                    <span class="material-icons text-primary">fastfood</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Total Orders</p>
                                    <h3 class="text-2xl font-bold text-gray-800" id="totalOrders">0</h3>
                                </div>
                                <div class="p-3 bg-green-100 rounded-full">
                                    <span class="material-icons text-green-500">receipt</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Total Customers</p>
                                    <h3 class="text-2xl font-bold text-gray-800" id="totalCustomers">0</h3>
                                </div>
                                <div class="p-3 bg-purple-100 rounded-full">
                                    <span class="material-icons text-purple-500">group</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6 hover-lift">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-gray-500">Total Revenue</p>
                                    <h3 class="text-2xl font-bold text-gray-800" id="totalRevenue">$0.00</h3>
                                </div>
                                <div class="p-3 bg-yellow-100 rounded-full">
                                    <span class="material-icons text-yellow-500">attach_money</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Orders -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold text-gray-800">Recent Orders</h2>
                            <a href="#" class="text-primary hover:underline view-all-orders">View All</a>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Order ID</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Customer</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Amount</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Status</th>
                                        <th class="px-4 py-3 text-left text-sm font-semibold text-gray-700">Date</th>
                                    </tr>
                                </thead>
                                <tbody id="recentOrdersTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="5" class="px-4 py-8 text-center text-gray-500">
                                            <div class="flex justify-center items-center gap-2">
                                                <span class="material-icons animate-spin">refresh</span>
                                                Loading orders...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Products Section -->
                <div id="products" class="content-section hidden">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Product Management</h1>
                                <p class="text-gray-600">Manage your restaurant's menu items</p>
                            </div>
                            <button id="createProductBtn" class="bg-primary hover:bg-primary-dark text-white px-6 py-3 rounded-lg flex items-center gap-2 transition hover-lift">
                                <span class="material-icons">add</span>
                                Create New Product
                            </button>
                        </div>
                    </div>

                    <!-- Add Product Form (Initially Hidden) -->
                    <div id="productFormContainer" class="bg-white rounded-lg card-shadow p-6 mb-6 hidden">
                        <h2 class="text-xl font-bold text-gray-800 mb-4" id="formTitle">Create New Product</h2>
                        <form id="productForm" class="space-y-4" enctype="multipart/form-data">
                            <input type="hidden" id="productId">

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Product Name *</label>
                                    <input type="text" id="productTitle" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                                        placeholder="Enter product name">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Category *</label>
                                    <select id="productCategory" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                        <option value="">Select category</option>
                                        <option value="Pizza">Pizza</option>
                                        <option value="Burgers">Burgers</option>
                                        <option value="Salads">Salads</option>
                                        <option value="Pasta">Pasta</option>
                                        <option value="Desserts">Desserts</option>
                                        <option value="Appetizers">Appetizers</option>
                                        <option value="Sides">Sides</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Description *</label>
                                <textarea id="productDescription" required rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                                    placeholder="Enter product description"></textarea>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Price *</label>
                                    <input type="number" id="productPrice" required step="0.01" min="0"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                                        placeholder="0.00">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Product Image *</label>
                                    <input type="file" id="productImage" accept="image/*" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                    <small class="text-gray-500">Upload product image (JPEG, PNG)</small>
                                </div>
                            </div>

                            <div class="flex gap-4 pt-4">
                                <button type="submit" id="submitBtn"
                                    class="bg-primary hover:bg-primary-dark text-white font-semibold py-3 px-8 rounded-lg transition hover-lift flex items-center gap-2">
                                    <span class="material-icons">save</span>
                                    Save Product
                                </button>
                                <button type="button" id="cancelBtn" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 px-6 rounded-lg transition hover-lift flex items-center gap-2">
                                    <span class="material-icons">cancel</span>
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Products Table -->
                    <div class="bg-white rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200">
                            <div class="flex justify-between items-center">
                                <h2 class="text-xl font-bold text-gray-800">Products List</h2>
                                <div class="flex gap-4">
                                    <div class="relative">
                                        <input type="text" id="searchInput" placeholder="Search products..."
                                            class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition w-64">
                                        <span class="material-icons absolute left-3 top-2 text-gray-400">search</span>
                                    </div>
                                    <select id="categoryFilter"
                                        class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                        <option value="">All Categories</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Image</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Name</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Category</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Price</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="5" class="px-6 py-8 text-center text-gray-500">
                                            <div class="flex justify-center items-center gap-2">
                                                <span class="material-icons animate-spin">refresh</span>
                                                Loading products...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div id="noProductsMessage" class="text-center py-8 text-gray-500 hidden">
                            <span class="material-icons text-4xl mb-2 text-gray-300">inventory_2</span>
                            <p>No products found. Add your first product above!</p>
                        </div>
                    </div>
                </div>

                <!-- Menu Section -->
                <div id="menu" class="content-section hidden">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Menu Management</h1>
                                <p class="text-gray-600">Create and manage your restaurant menus</p>
                            </div>
                            <button id="createMenuBtn" class="bg-primary hover:bg-primary-dark text-white px-6 py-3 rounded-lg flex items-center gap-2 transition hover-lift">
                                <span class="material-icons">add</span>
                                Create New Menu
                            </button>
                        </div>
                    </div>

                    <!-- Menu Form (Initially Hidden) -->
                    <div id="menuFormContainer" class="bg-white rounded-lg card-shadow p-6 mb-6 hidden">
                        <h2 class="text-xl font-bold text-gray-800 mb-4" id="menuFormTitle">Create New Menu</h2>
                        <form id="menuForm" class="space-y-4" enctype="multipart/form-data">
                            <input type="hidden" id="menuId">

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Menu Name *</label>
                                    <input type="text" id="menuName" required
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                                        placeholder="Enter menu name">
                                </div>
                                <div>
                                    <label class="block text-gray-700 font-semibold mb-2">Category</label>
                                    <select id="menuCategory"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                        <option value="main">Main Menu</option>
                                        <option value="breakfast">Breakfast</option>
                                        <option value="lunch">Lunch</option>
                                        <option value="dinner">Dinner</option>
                                        <option value="specials">Specials</option>
                                        <option value="kids">Kids Menu</option>
                                    </select>
                                </div>
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Description</label>
                                <textarea id="menuDescription" rows="3"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition"
                                    placeholder="Enter menu description"></textarea>
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Menu Image</label>
                                <input type="file" id="menuImage" accept="image/*"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                <small class="text-gray-500">Upload menu cover image (JPEG, PNG)</small>
                            </div>

                            <div class="flex items-center gap-3">
                                <input type="checkbox" id="menuVisible" class="rounded text-primary focus:ring-primary">
                                <label for="menuVisible" class="text-gray-700">Visible to customers</label>
                            </div>

                            <div>
                                <label class="block text-gray-700 font-semibold mb-2">Select Products *</label>
                                <div id="menuProductsList" class="border border-gray-300 rounded-lg p-4 max-h-60 overflow-y-auto bg-gray-50">
                                    <div class="text-center text-gray-500 py-4">
                                        <span class="material-icons animate-spin">refresh</span>
                                        <p>Loading products...</p>
                                    </div>
                                </div>
                            </div>

                            <div class="flex gap-4 pt-4">
                                <button type="submit" id="submitMenuBtn"
                                    class="bg-primary hover:bg-primary-dark text-white font-semibold py-3 px-8 rounded-lg transition hover-lift flex items-center gap-2">
                                    <span class="material-icons">save</span>
                                    Save Menu
                                </button>
                                <button type="button" id="cancelMenuBtn" class="bg-gray-500 hover:bg-gray-600 text-white font-semibold py-3 px-6 rounded-lg transition hover-lift flex items-center gap-2">
                                    <span class="material-icons">cancel</span>
                                    Cancel
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Menu List -->
                    <div class="bg-white rounded-lg card-shadow overflow-hidden">
                        <div class="p-6 border-b border-gray-200">
                            <h3 class="text-xl font-bold text-gray-800">Current Menus</h3>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Image</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Menu Name</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Description</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Items</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="menusTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="5" class="px-6 py-8 text-center text-gray-500">
                                            <div class="flex justify-center items-center gap-2">
                                                <span class="material-icons animate-spin">refresh</span>
                                                Loading menus...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Orders Section -->
                <div id="orders" class="content-section hidden">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Order Management</h1>
                                <p class="text-gray-600">View and manage customer orders</p>
                            </div>
                            <div class="flex gap-4">
                                <div class="relative">
                                    <input type="text" id="orderSearchInput" placeholder="Search orders..."
                                        class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition w-64">
                                    <span class="material-icons absolute left-3 top-2 text-gray-400">search</span>
                                </div>
                                <select id="orderStatusFilter"
                                    class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                    <option value="">All Status</option>
                                    <option value="pending">Pending</option>
                                    <option value="preparing">Preparing</option>
                                    <option value="completed">Completed</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Orders Table -->
                    <div class="bg-white rounded-lg card-shadow overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Order ID</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Customer</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Items</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Total</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Status</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Date</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="7" class="px-6 py-8 text-center text-gray-500">
                                            <div class="flex justify-center items-center gap-2">
                                                <span class="material-icons animate-spin">refresh</span>
                                                Loading orders...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Customers Section -->
                <div id="customers" class="content-section hidden">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Customer Management</h1>
                                <p class="text-gray-600">View and manage customer information</p>
                            </div>
                            <div class="relative">
                                <input type="text" id="customerSearchInput" placeholder="Search customers..."
                                    class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition w-64">
                                <span class="material-icons absolute left-3 top-2 text-gray-400">search</span>
                            </div>
                        </div>
                    </div>

                    <!-- Customers Table -->
                    <div class="bg-white rounded-lg card-shadow overflow-hidden">
                        <div class="overflow-x-auto">
                            <table class="w-full">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Customer ID</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Name</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Email</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Phone</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Orders</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Total Spent</th>
                                        <th class="px-6 py-4 text-left text-sm font-semibold text-gray-700">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="customersTable" class="divide-y divide-gray-200">
                                    <tr>
                                        <td colspan="7" class="px-6 py-8 text-center text-gray-500">
                                            <div class="flex justify-center items-center gap-2">
                                                <span class="material-icons animate-spin">refresh</span>
                                                Loading customers...
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Analytics Section -->
                <div id="analytics" class="content-section hidden">
                    <!-- Header Card -->
                    <div class="bg-white rounded-lg card-shadow p-6 mb-6">
                        <div class="flex justify-between items-center">
                            <div>
                                <h1 class="text-2xl font-bold text-gray-800">Analytics</h1>
                                <p class="text-gray-600">View insights about your restaurant performance</p>
                            </div>
                            <div class="flex gap-4">
                                <select id="analyticsPeriod"
                                    class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:outline-none transition">
                                    <option value="7">Last 7 days</option>
                                    <option value="30" selected>Last 30 days</option>
                                    <option value="90">Last 90 days</option>
                                    <option value="365">Last year</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-6">
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Revenue Overview</h3>
                            <div class="h-64 flex items-center justify-center text-gray-500 bg-gray-50 rounded-lg">
                                <div class="text-center">
                                    <span class="material-icons text-4xl mb-2 text-gray-400">bar_chart</span>
                                    <p>Revenue chart will be displayed here</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Top Products</h3>
                            <div class="h-64 flex items-center justify-center text-gray-500 bg-gray-50 rounded-lg">
                                <div class="text-center">
                                    <span class="material-icons text-4xl mb-2 text-gray-400">pie_chart</span>
                                    <p>Top products chart will be displayed here</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white rounded-lg card-shadow p-6">
                            <h3 class="text-lg font-semibold text-gray-800 mb-4">Order Status</h3>
                            <div class="h-64 flex items-center justify-center text-gray-500 bg-gray-50 rounded-lg">
                                <div class="text-center">
                                    <span class="material-icons text-4xl mb-2 text-gray-400">donut_large</span>
                                    <p>Order status chart will be displayed here</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-lg card-shadow p-6">
                        <h3 class="text-lg font-semibold text-gray-800 mb-4">Recent Activity</h3>
                        <div id="recentActivity" class="space-y-4">
                            <div class="flex items-center gap-4 p-3 bg-blue-50 rounded-lg">
                                <div class="p-2 bg-blue-100 rounded-full">
                                    <span class="material-icons text-primary">shopping_cart</span>
                                </div>
                                <div>
                                    <p class="font-medium">New order received</p>
                                    <p class="text-sm text-gray-500">Order #1234 from John Doe</p>
                                </div>
                                <div class="ml-auto text-sm text-gray-500">2 hours ago</div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // API Configuration
        const API_BASE = window.location.origin + '/api';

        // Global State
        let currentProducts = [];
        let currentMenus = [];
        let currentOrders = [];
        let currentCustomers = [];

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const currentDate = new Date().toLocaleDateString('en-US', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('currentDate').textContent = currentDate;

            // Initialize all components
            initNavigation();
            initProducts();
            initMenu();
            initOrders();
            initCustomers();
            initAnalytics();

            // Show dashboard by default
            showSection('dashboard');
        });

        // API Helper Functions
        async function apiCall(endpoint, options = {}) {
            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    },
                    ...options
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                return await response.json();
            } catch (error) {
                console.error('API call failed:', error);
                showNotification('Error: ' + error.message, 'error');
                throw error;
            }
        }

        // Notification System
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'error' ? 'bg-red-500 text-white' :
                type === 'success' ? 'bg-green-500 text-white' :
                'bg-blue-500 text-white'
            }`;
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="material-icons">${type === 'error' ? 'error' : type === 'success' ? 'check_circle' : 'info'}</span>
                    <span>${message}</span>
                </div>
            `;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Navigation
        function initNavigation() {
            const navItems = document.querySelectorAll('.nav-item');

            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();

                    // Remove active class from all nav items
                    navItems.forEach(navItem => {
                        navItem.classList.remove('active-nav');
                        navItem.classList.remove('bg-blue-700');
                    });

                    // Add active class to clicked nav item
                    this.classList.add('active-nav');
                    this.classList.add('bg-blue-700');

                    // Show the corresponding section
                    const section = this.getAttribute('data-section');
                    showSection(section);
                });
            });

            // View all orders link
            document.querySelector('.view-all-orders').addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelector('[data-section="orders"]').click();
            });
        }

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.add('hidden');
            });

            // Show the selected section
            document.getElementById(sectionId).classList.remove('hidden');

            // Update breadcrumb
            updateBreadcrumb(sectionId);

            // Load section-specific data
            switch(sectionId) {
                case 'dashboard':
                    loadDashboardData();
                    break;
                case 'products':
                    loadProducts();
                    break;
                case 'menu':
                    loadMenus();
                    break;
                case 'orders':
                    loadOrders();
                    break;
                case 'customers':
                    loadCustomers();
                    break;
                case 'analytics':
                    loadAnalytics();
                    break;
            }
        }

        function updateBreadcrumb(sectionId) {
            const breadcrumb = document.getElementById('breadcrumb');
            breadcrumb.textContent = 'Home / ' + sectionId.charAt(0).toUpperCase() + sectionId.slice(1);
        }

        // Products Management
        function initProducts() {
            // Product form handling
            document.getElementById('createProductBtn').addEventListener('click', function() {
                document.getElementById('productFormContainer').classList.remove('hidden');
                document.getElementById('productForm').reset();
                document.getElementById('productId').value = '';
                document.getElementById('formTitle').textContent = 'Create New Product';
                document.getElementById('submitBtn').textContent = 'Save Product';
            });

            document.getElementById('cancelBtn').addEventListener('click', function() {
                document.getElementById('productFormContainer').classList.add('hidden');
            });

            // Search functionality
            document.getElementById('searchInput').addEventListener('input', loadProducts);
            document.getElementById('categoryFilter').addEventListener('change', loadProducts);
        }

        // Handle product form submission
        document.getElementById('productForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const formData = new FormData();
            formData.append('name', document.getElementById('productTitle').value);
            formData.append('category', document.getElementById('productCategory').value);
            formData.append('description', document.getElementById('productDescription').value);
            formData.append('price', document.getElementById('productPrice').value);

            const imageFile = document.getElementById('productImage').files[0];
            if (imageFile) {
                formData.append('image', imageFile);
            }

            const productId = document.getElementById('productId').value;
            const url = productId ? `${API_BASE}/products/${productId}` : `${API_BASE}/products`;
            const method = productId ? 'PUT' : 'POST';

            try {
                const response = await fetch(url, {
                    method,
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`Product ${productId ? 'updated' : 'created'} successfully!`, 'success');
                    document.getElementById('productForm').reset();
                    document.getElementById('productFormContainer').classList.add('hidden');
                    loadProducts();
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to save product', 'error');
                }
            } catch (err) {
                console.error(`Failed to ${productId ? 'update' : 'create'} product:`, err);
                showNotification('Failed to save product', 'error');
            }
        });

        // Load products
        async function loadProducts() {
            try {
                const products = await apiCall('/products');
                currentProducts = products;

                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                const categoryFilter = document.getElementById('categoryFilter').value;

                const filteredProducts = products.filter(product => {
                    const matchesSearch = product.name.toLowerCase().includes(searchTerm) ||
                                        product.description.toLowerCase().includes(searchTerm);
                    const matchesCategory = !categoryFilter || product.category === categoryFilter;
                    return matchesSearch && matchesCategory;
                });

                const productsTable = document.getElementById('productsTable');
                if (filteredProducts.length === 0) {
                    productsTable.innerHTML = '<tr><td colspan="5" class="px-6 py-8 text-center text-gray-500">No products found</td></tr>';
                } else {
                    productsTable.innerHTML = filteredProducts.map(product => `
                        <tr class="hover:bg-gray-50">
                            <td class="px-6 py-4">
                                <img src="${product.image_url || '/static/placeholder.jpg'}" alt="${product.name}"
                                     class="w-12 h-12 object-cover rounded">
                            </td>
                            <td class="px-6 py-4 font-medium">${product.name}</td>
                            <td class="px-6 py-4">
                                <span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">
                                    ${product.category}
                                </span>
                            </td>
                            <td class="px-6 py-4 font-semibold">$${parseFloat(product.price || 0).toFixed(2)}</td>
                            <td class="px-6 py-4">
                                <button onclick="editProduct(${product.id})" class="text-blue-500 hover:text-blue-700 mr-2">Edit</button>
                                <button onclick="deleteProduct(${product.id})" class="text-red-500 hover:text-red-700">Delete</button>
                            </td>
                        </tr>
                    `).join('');
                }

                // Update category filter options
                const categories = [...new Set(products.map(p => p.category))];
                const categoryFilterEl = document.getElementById('categoryFilter');
                categoryFilterEl.innerHTML = '<option value="">All Categories</option>' +
                    categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');

            } catch (err) {
                console.error('Failed to load products:', err);
                document.getElementById('productsTable').innerHTML =
                    '<tr><td colspan="5" class="px-6 py-8 text-center text-red-500">Failed to load products</td></tr>';
            }
        }

        // Menu Management
        function initMenu() {
            // Menu form handling
            document.getElementById('createMenuBtn').addEventListener('click', function() {
                document.getElementById('menuFormContainer').classList.remove('hidden');
                document.getElementById('menuForm').reset();
                document.getElementById('menuId').value = '';
                document.getElementById('menuFormTitle').textContent = 'Create New Menu';
                document.getElementById('submitMenuBtn').textContent = 'Save Menu';
                loadProductsForMenu();
            });

            document.getElementById('cancelMenuBtn').addEventListener('click', function() {
                document.getElementById('menuFormContainer').classList.add('hidden');
            });
        }

        // Handle menu form submission
        document.getElementById('menuForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const formData = new FormData();
            formData.append('name', document.getElementById('menuName').value);
            formData.append('description', document.getElementById('menuDescription').value);
            formData.append('category', document.getElementById('menuCategory').value);
            formData.append('is_visible', document.getElementById('menuVisible').checked);

            // Add selected products
            const selectedProducts = Array.from(document.querySelectorAll('#menuProductsList input[type="checkbox"]:checked')).map(cb => cb.value);
            formData.append('product_ids', JSON.stringify(selectedProducts));

            // Add image file if provided
            const imageFile = document.getElementById('menuImage').files[0];
            if (imageFile) {
                formData.append('image', imageFile);
            }

            const menuId = document.getElementById('menuId').value;
            const url = menuId ? `${API_BASE}/menus/${menuId}` : `${API_BASE}/menus`;
            const method = menuId ? 'PUT' : 'POST';

            try {
                const response = await fetch(url, {
                    method,
                    body: formData
                });

                if (response.ok) {
                    const result = await response.json();
                    showNotification(`Menu ${menuId ? 'updated' : 'created'} successfully!`, 'success');
                    document.getElementById('menuFormContainer').classList.add('hidden');
                    loadMenus();
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to save menu', 'error');
                }
            } catch (err) {
                console.error(`Failed to ${menuId ? 'update' : 'create'} menu:`, err);
                showNotification('Failed to save menu', 'error');
            }
        });

        // Load products for menu selection
        async function loadProductsForMenu() {
            try {
                const products = await apiCall('/products');

                const productsList = document.getElementById('menuProductsList');
                productsList.innerHTML = products.map(product => `
                    <div class="flex items-center gap-3 mb-3">
                        <input type="checkbox" id="product-${product.id}" value="${product.id}"
                               class="rounded text-primary focus:ring-primary">
                        <label for="product-${product.id}" class="text-gray-700">
                            ${product.name} - $${parseFloat(product.price || 0).toFixed(2)}
                        </label>
                    </div>
                `).join('');
            } catch (err) {
                console.error('Failed to load products:', err);
            }
        }

        // Load and display menus
        async function loadMenus() {
            try {
                const menus = await apiCall('/menus');

                const menuTable = document.getElementById('menusTable');
                menuTable.innerHTML = menus.map(menu => `
                    <tr>
                        <td class="px-6 py-4">
                            <img src="${menu.image_url || '/static/placeholder.jpg'}" alt="${menu.name}"
                                 class="w-12 h-12 object-cover rounded">
                        </td>
                        <td class="px-6 py-4">${menu.name}</td>
                        <td class="px-6 py-4">${menu.description || '-'}</td>
                        <td class="px-6 py-4">${menu.products ? menu.products.length : 0} items</td>
                        <td class="px-6 py-4">
                            <button onclick="editMenu(${menu.id})" class="text-blue-500 hover:text-blue-700 mr-2">Edit</button>
                            <button onclick="deleteMenu(${menu.id})" class="text-red-500 hover:text-red-700">Delete</button>
                        </td>
                    </tr>
                `).join('');
            } catch (err) {
                console.error('Failed to load menus:', err);
            }
        }

        // Orders Management
        function initOrders() {
            document.getElementById('orderSearchInput').addEventListener('input', loadOrders);
            document.getElementById('orderStatusFilter').addEventListener('change', loadOrders);
        }

        // Load orders
        async function loadOrders() {
            try {
                const orders = await apiCall('/orders');
                currentOrders = orders;

                const searchTerm = document.getElementById('orderSearchInput').value.toLowerCase();
                const statusFilter = document.getElementById('orderStatusFilter').value;

                const filteredOrders = orders.filter(order => {
                    const matchesSearch = order.id.toString().includes(searchTerm) ||
                                        (order.customer_name && order.customer_name.toLowerCase().includes(searchTerm));
                    const matchesStatus = !statusFilter || order.status === statusFilter;
                    return matchesSearch && matchesStatus;
                });

                const ordersTable = document.getElementById('ordersTable');
                ordersTable.innerHTML = filteredOrders.map(order => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 font-medium">#${order.id}</td>
                        <td class="px-6 py-4">${order.customer_name || 'N/A'}</td>
                        <td class="px-6 py-4">
                            ${order.items ? order.items.map(item => `${item.quantity}x ${item.product_name}`).join(', ') : 'N/A'}
                        </td>
                        <td class="px-6 py-4 font-semibold">$${parseFloat(order.total_amount || 0).toFixed(2)}</td>
                        <td class="px-6 py-4">
                            <select onchange="updateOrderStatus(${order.id}, this.value)"
                                    class="px-2 py-1 border rounded text-xs">
                                <option value="pending" ${order.status === 'pending' ? 'selected' : ''}>Pending</option>
                                <option value="preparing" ${order.status === 'preparing' ? 'selected' : ''}>Preparing</option>
                                <option value="completed" ${order.status === 'completed' ? 'selected' : ''}>Completed</option>
                                <option value="cancelled" ${order.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                            </select>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-500">
                            ${new Date(order.order_date).toLocaleDateString()}
                        </td>
                        <td class="px-6 py-4">
                            <button onclick="viewOrderDetails(${order.id})" class="text-blue-500 hover:text-blue-700">View</button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="7" class="px-6 py-8 text-center text-gray-500">No orders found</td></tr>';
            } catch (err) {
                console.error('Failed to load orders:', err);
                document.getElementById('ordersTable').innerHTML =
                    '<tr><td colspan="7" class="px-6 py-8 text-center text-red-500">Failed to load orders</td></tr>';
            }
        }

        // Customers Management
        function initCustomers() {
            document.getElementById('customerSearchInput').addEventListener('input', loadCustomers);
        }

        // Load customers
        async function loadCustomers() {
            try {
                const customers = await apiCall('/customers');
                currentCustomers = customers;

                const searchTerm = document.getElementById('customerSearchInput').value.toLowerCase();

                const filteredCustomers = customers.filter(customer =>
                    customer.name.toLowerCase().includes(searchTerm) ||
                    customer.email.toLowerCase().includes(searchTerm)
                );

                const customersTable = document.getElementById('customersTable');
                customersTable.innerHTML = filteredCustomers.map(customer => `
                    <tr class="hover:bg-gray-50">
                        <td class="px-6 py-4 font-medium">${customer.id}</td>
                        <td class="px-6 py-4 font-medium">${customer.name}</td>
                        <td class="px-6 py-4">${customer.email}</td>
                        <td class="px-6 py-4">${customer.phone}</td>
                        <td class="px-6 py-4">${customer.orders_count || 0}</td>
                        <td class="px-6 py-4 font-semibold">$${(typeof customer.total_spent === 'number' && !isNaN(customer.total_spent)) ? customer.total_spent.toFixed(2) : '0.00'}</td>
                        <td class="px-6 py-4">
                            <button onclick="viewCustomerDetails(${customer.id})" class="text-blue-500 hover:text-blue-700">View</button>
                        </td>
                    </tr>
                `).join('') || '<tr><td colspan="7" class="px-6 py-8 text-center text-gray-500">No customers found</td></tr>';
            } catch (err) {
                console.error('Failed to load customers:', err);
                document.getElementById('customersTable').innerHTML =
                    '<tr><td colspan="7" class="px-6 py-8 text-center text-red-500">Failed to load customers</td></tr>';
            }
        }

        // Analytics (Placeholder)
        function initAnalytics() {
            document.getElementById('analyticsPeriod').addEventListener('change', loadAnalytics);
        }

        async function loadAnalytics() {
            console.log('Analytics loaded');
        }

        // Dashboard
        async function loadDashboardData() {
            try {
                const stats = await apiCall('/dashboard/stats');
                document.getElementById('totalProducts').textContent = stats.total_products;
                document.getElementById('totalOrders').textContent = stats.total_orders;
                document.getElementById('totalCustomers').textContent = stats.total_customers;
                document.getElementById('totalRevenue').textContent = `$${parseFloat(stats.total_revenue || 0).toFixed(2)}`;

                // Load recent orders
                const recentOrdersTable = document.getElementById('recentOrdersTable');
                recentOrdersTable.innerHTML = stats.recent_orders.map(order => `
                    <tr>
                        <td class="px-4 py-3">${order.id}</td>
                        <td class="px-4 py-3">${order.customer_name || 'N/A'}</td>
                        <td class="px-4 py-3">$${parseFloat(order.total_amount || 0).toFixed(2)}</td>
                        <td class="px-4 py-3">
                            <span class="px-2 py-1 rounded-full text-xs status-${order.status.toLowerCase()}">
                                ${order.status}
                            </span>
                        </td>
                        <td class="px-4 py-3">${new Date(order.order_date).toLocaleDateString()}</td>
                    </tr>
                `).join('') || '<tr><td colspan="5" class="px-4 py-8 text-center text-gray-500">No recent orders</td></tr>';
            } catch (err) {
                console.error('Failed to load dashboard data:', err);
            }
        }

        // Utility Functions
        async function editProduct(productId) {
            try {
                const product = currentProducts.find(p => p.id === productId);
                if (!product) return;

                document.getElementById('productId').value = product.id;
                document.getElementById('productTitle').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productDescription').value = product.description || '';
                document.getElementById('productPrice').value = product.price;

                document.getElementById('formTitle').textContent = 'Edit Product';
                document.getElementById('submitBtn').textContent = 'Update Product';
                document.getElementById('productFormContainer').classList.remove('hidden');
            } catch (err) {
                console.error('Failed to edit product:', err);
                showNotification('Failed to load product details', 'error');
            }
        }

        async function deleteProduct(productId) {
            if (!confirm('Are you sure you want to delete this product?')) return;

            try {
                const response = await fetch(`${API_BASE}/products/${productId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showNotification('Product deleted successfully!', 'success');
                    loadProducts();
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to delete product', 'error');
                }
            } catch (err) {
                console.error('Failed to delete product:', err);
                showNotification('Failed to delete product', 'error');
            }
        }

        async function editMenu(menuId) {
            try {
                const menu = await apiCall(`/menus/${menuId}`);

                // Load products for selection
                await loadProductsForMenu();

                // Populate form
                document.getElementById('menuId').value = menu.id;
                document.getElementById('menuName').value = menu.name;
                document.getElementById('menuDescription').value = menu.description || '';
                document.getElementById('menuCategory').value = menu.category || 'main';
                document.getElementById('menuVisible').checked = menu.is_visible;

                // Check selected products
                if (menu.products) {
                    menu.products.forEach(product => {
                        const checkbox = document.querySelector(`#product-${product.id}`);
                        if (checkbox) checkbox.checked = true;
                    });
                }

                // Show form
                document.getElementById('menuFormTitle').textContent = 'Edit Menu';
                document.getElementById('menuFormContainer').classList.remove('hidden');
            } catch (err) {
                console.error('Failed to edit menu:', err);
                showNotification('Failed to load menu details', 'error');
            }
        }

        async function deleteMenu(menuId) {
            if (!confirm('Are you sure you want to delete this menu?')) return;

            try {
                const response = await fetch(`${API_BASE}/menus/${menuId}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    showNotification('Menu deleted successfully!', 'success');
                    loadMenus();
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to delete menu', 'error');
                }
            } catch (err) {
                console.error('Failed to delete menu:', err);
                showNotification('Failed to delete menu', 'error');
            }
        }

        async function updateOrderStatus(orderId, status) {
            try {
                const response = await fetch(`${API_BASE}/orders/${orderId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status })
                });

                if (response.ok) {
                    showNotification('Order status updated successfully!', 'success');
                    loadOrders();
                    loadDashboardData();
                } else {
                    const error = await response.json();
                    showNotification(error.error || 'Failed to update order status', 'error');
                }
            } catch (err) {
                console.error('Failed to update order status:', err);
                showNotification('Failed to update order status', 'error');
            }
        }

        function viewOrderDetails(orderId) {
            const order = currentOrders.find(o => o.id === orderId);
            if (order) {
                alert(`Order #${order.id}\nCustomer: ${order.customer_name || 'N/A'}\nTotal: $${parseFloat(order.total_amount || 0).toFixed(2)}\nStatus: ${order.status}\nDate: ${new Date(order.order_date).toLocaleDateString()}\n\nItems:\n${order.items ? order.items.map(item => `- ${item.quantity}x ${item.product_name} ($${parseFloat(item.price || 0).toFixed(2)} each)`).join('\n') : 'No items'}`);
            }
        }

        function viewCustomerDetails(customerId) {
            const customer = currentCustomers.find(c => c.id === customerId);
            if (customer) {
                const totalSpent = (typeof customer.total_spent === 'number' && !isNaN(customer.total_spent)) ? customer.total_spent.toFixed(2) : '0.00';
                const ordersCount = customer.orders_count || 0;
                alert(`Customer: ${customer.name}\nEmail: ${customer.email}\nPhone: ${customer.phone}\nOrders: ${ordersCount}\nTotal Spent: $${totalSpent}`);
            }
        }
    </script>
</body>
</html>
